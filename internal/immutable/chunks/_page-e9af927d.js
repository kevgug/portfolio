import{d as C}from"./marked-c7288604.js";import{e as at}from"./index-b40a4f3c.js";import{_ as Y}from"./preload-helper-41c905a7.js";function rt(o,l,c,e,n){var st,it;const s=o.split(/\r?\n/);let t=0;if(((st=s[t])==null?void 0:st.trim())==="---"){for(t++;t<s.length&&((it=s[t])==null?void 0:it.trim())!=="---";)t++;t++}for(;t<s.length&&s[t].trim()==="";)t++;const g=l||(()=>{const _=s[t]||"";return t++,_.replace(/^#\s*/,"").trim()})(),k=c||(()=>{for(;t<s.length&&s[t].trim()==="";)t++;return(s[t]||"").trim()})(),j=g,E=k;if(l||t++,!c){for(;t<s.length&&s[t].trim()==="";)t++;t++}const p=[],f={};let I="",u=null,v=!1,P=[],B=null,x=[],A=!1,F=!1,V="",d=[],y=!1,a=[],$=!1,m=[],S=!1,N=!1,q=[],D=!1,O=[],r=!1,h=[];const M=()=>{if(P.length>0){const _=P.some(w=>w.endsWith("\\"));let i;if(_?i=P.map(w=>w.endsWith("\\")?w.slice(0,-1).trim():w.trim()).join("<br>").trim():i=P.join(" ").trim(),i){const w={type:"paragraph",tokens:R(i,e,n)};u?u.content.push(w):r||h.push(w)}}P=[]},Z=()=>{if(m.length>0){const _={type:"list",ordered:S,items:m.map(i=>R(i,e,n))};u?u.content.push(_):r||h.push(_)}m=[],$=!1,S=!1},z=()=>{if(q.length>0){let _,i=[...q];for(let b=i.length-1;b>=0;b--){const W=i[b].trim();if(W){W.startsWith("- ")&&(_=C.parseInline(W.substring(2).trim()),i=i.slice(0,b));break}}i.length===0&&_&&(i=[""]);const w=i.filter(b=>b.trim()!==""),H=w.length>1,G=i.some(b=>b.endsWith("\\"));let T,J,Q=!1,X;if(G||H){const b=w[w.length-1];Q=b?b.endsWith("\\"):!1,X=w.map(W=>{const K=W.endsWith("\\")?W.slice(0,-1).trim():W.trim();return R(K,e,n)}),T=w.map(W=>W.endsWith("\\")?W.slice(0,-1).trim():W.trim()).join(" ").trim(),J=!0}else T=i.join(" ").trim(),J=!1;const L={type:"blockquote",tokens:R(T,e,n),...X&&{paragraphs:X},multiline:J,endsWithBreak:Q,..._&&{citation:_}};u?u.content.push(L):r||h.push(L)}q=[],N=!1},U=()=>{if(O.length>=3){const _=G=>{const T=G.split("|").map(J=>J.trim());return T[0]===""&&T.shift(),T.length>0&&T[T.length-1]===""&&T.pop(),T},i=_(O[0]),w=O.slice(2).map(G=>_(G)),H={type:"table",headers:i,rows:w};u?u.content.push(H):r||h.push(H)}O=[],D=!1};for(;t<s.length;t++){const _=s[t]??"",i=_.replace(/\t/g,"    ");if(F){if(i.trim()==="```"){const L={type:"code",lang:V,code:d.join(`
`)};u?u.content.push(L):r||h.push(L),F=!1,d=[],V=""}else d.push(_);continue}if(y){const L=i.trim().match(/^\$\$(?:\s*\[(\d+)\])?$/);if(L){const b=L[1],K={type:"latex",latex:a.join(`
`).replace(/\\_/g,"_"),...b&&{footnoteRef:b}};u?u.content.push(K):r||h.push(K),y=!1,a=[]}else a.push(i);continue}const w=i.match(/^```(\w*)/);if(w){M(),Z(),z(),U(),F=!0,V=w[1]||"";continue}if(i.trim()==="$$"){M(),Z(),z(),U(),y=!0;continue}const H=i.match(/^\s*!\[([^\]]*)\]\(([^)]+)\)\s*$/);if(H){M(),Z(),z(),U();const L=(H[1]||"").trim(),b=(H[2]||"").trim();let W;if(t+1<s.length){const ot=(s[t+1]??"").match(/^\s*[*_](.+)[*_]\s*$/);ot&&(W=(ot[1]||"").trim(),t++)}const K={type:"image",path:b,alt:L||b,caption:W};u?u.content.push(K):r||h.push(K);continue}const G=i.match(/^##\s+(.*)$/);if(G){M(),Z(),z(),U();const L=(G[1]||"").trim();v=/^notes$/i.test(L),v?u=null:(r=!0,u={heading:L,content:[]},p.push(u));continue}if(v){if(i.trim()==="---"){B&&x.length>0&&(f[B]=nt(x,e,n),x=[],B=null),A=!0;continue}if(A){I&&(I+=`
`),I+=_;continue}const L=i.match(/^\[(\d+)\]\s*(.*)$/);if(L){B&&x.length>0&&(f[B]=nt(x,e,n),x=[]),B=L[1];const b=(L[2]||"").trim();b&&x.push(b)}else B&&i.trim()?x.push(i.trim()):i.trim()===""&&B&&x.push("");continue}const T=i.match(/^\s*(?:-|\*|\+)\s+(.*)/);if(T){$||(M(),$=!0,S=!1),m.push((T[1]||"").trim());continue}const J=i.match(/^\s*\d+\.\s+(.*)/);if(J){$||(M(),$=!0,S=!0),m.push((J[1]||"").trim());continue}const Q=i.match(/^\s{2,}(.*)/);if($&&Q&&(Q[1]||"").trim()&&m.length>0){const L=m[m.length-1];L.endsWith("\\")?m[m.length-1]=L.slice(0,-1).trim()+"<br>"+(Q[1]||"").trim():m[m.length-1]+=" "+(Q[1]||"").trim();continue}$&&Z();const X=i.match(/^>\s*(.*)$/);if(X){N||(M(),N=!0),q.push((X[1]||"").trim());continue}N&&z();const et=i.match(/^\s*\|.*\|\s*$/);if(et&&t+1<s.length){const L=s[t+1]??"";if(/^\s*\|[\s\-:|]+\|\s*$/.test(L)){D||(M(),Z(),D=!0),O.push(i.trim());continue}}if(D&&et){O.push(i.trim());continue}if(D&&U(),i.trim()===""){M();continue}P.push(i.trim())}M(),Z(),z(),U(),B&&x.length>0&&(f[B]=nt(x,e,n)),!r&&h.length>0?p.push({heading:j,content:h}):r&&h.length>0&&p.unshift({heading:"Foreword",content:h});const tt=I?ct(I,e,n):void 0;return{title:j,date:E,sections:p,footnotes:f,contributionNote:tt&&tt.length>0?tt:void 0,audioConfig:e}}function R(o,l,c){const e=[],n=/`([^`\n]+)`/g,s=[];let t;for(;t=n.exec(o);)s.push({start:t.index,end:t.index+t[0].length,code:t[1]});let g=0;for(const k of s){if(k.start>g){const f=o.slice(g,k.start);e.push(...lt(f))}const j=k.code,E=l==null?void 0:l[j],p=(c==null?void 0:c.has(j))??!1;e.push({type:"code",code:j,audio:E,copyable:p}),g=k.end}if(g<o.length){const k=o.slice(g);e.push(...lt(k))}return e}function lt(o){const l=[],c=new RegExp("(\\[\\d+\\])|(?<!\\\\)\\$\\$([^\\n]+?)\\$\\$","g");let e=0,n;for(;n=c.exec(o);){const s=n.index,t=s+n[0].length;if(s>e){const g=o.slice(e,s);l.push({type:"text",text:C.parseInline(g)})}if(n[1]){const g=n[1].match(/\[(\d+)\]/);g&&l.push({type:"ref",num:g[1]})}else n[2]&&l.push({type:"latex",latex:n[2]});e=t}return e<o.length&&l.push({type:"text",text:C.parseInline(o.slice(e))}),l}function ct(o,l,c){const e=o.split(/\r?\n/),n=[];let s=[],t=!1,g="",k=[],j=!1,E=[],p=!1,f=[],I=!1,u=!1,v=[],P=!1,B=[];const x=()=>{if(s.length>0){const d=s.some(a=>a.endsWith("\\"));let y;d?y=s.map(a=>a.endsWith("\\")?a.slice(0,-1).trim():a.trim()).join("<br>").trim():y=s.join(" ").trim(),y&&n.push({type:"paragraph",tokens:R(y,l,c)})}s=[]},A=()=>{f.length>0&&n.push({type:"list",ordered:I,items:f.map(d=>R(d,l,c))}),f=[],p=!1,I=!1},F=()=>{if(v.length>0){let d,y=[...v];for(let r=y.length-1;r>=0;r--){const h=y[r].trim();if(h){h.startsWith("- ")&&(d=C.parseInline(h.substring(2).trim()),y=y.slice(0,r));break}}y.length===0&&d&&(y=[""]);const a=y.filter(r=>r.trim()!==""),$=a.length>1,m=y.some(r=>r.endsWith("\\"));let S,N,q=!1,D;if(m||$){const r=a[a.length-1];q=r?r.endsWith("\\"):!1,D=a.map(h=>{const M=h.endsWith("\\")?h.slice(0,-1).trim():h.trim();return R(M,l,c)}),S=a.map(h=>h.endsWith("\\")?h.slice(0,-1).trim():h.trim()).join(" ").trim(),N=!0}else S=y.join(" ").trim(),N=!1;const O=R(S,l,c);n.push({type:"blockquote",tokens:O,...D&&{paragraphs:D},multiline:N,endsWithBreak:q,...d&&{citation:d}})}v=[],u=!1},V=()=>{if(B.length>=3){const d=$=>{const m=$.split("|").map(S=>S.trim());return m[0]===""&&m.shift(),m.length>0&&m[m.length-1]===""&&m.pop(),m},y=d(B[0]),a=B.slice(2).map($=>d($));n.push({type:"table",headers:y,rows:a})}B=[],P=!1};for(let d=0;d<e.length;d++){const y=e[d]??"",a=y.replace(/\t/g,"    ");if(t){a.trim()==="```"?(n.push({type:"code",lang:g,code:k.join(`
`)}),t=!1,k=[],g=""):k.push(y);continue}if(j){const r=a.trim().match(/^\$\$(?:\s*\[(\d+)\])?$/);if(r){const h=r[1],M=E.join(`
`).replace(/\\_/g,"_");n.push({type:"latex",latex:M,...h&&{footnoteRef:h}}),j=!1,E=[]}else E.push(a);continue}const $=a.match(/^```(\w*)/);if($){x(),A(),F(),V(),t=!0,g=$[1]||"";continue}if(a.trim()==="$$"){x(),A(),F(),V(),j=!0;continue}const m=a.match(/^\s*!\[([^\]]*)\]\(([^)]+)\)\s*$/);if(m){x(),A(),F(),V();const r=(m[1]||"").trim(),h=(m[2]||"").trim();let M;if(d+1<e.length){const z=(e[d+1]??"").match(/^\s*[*_](.+)[*_]\s*$/);z&&(M=(z[1]||"").trim(),d++)}n.push({type:"image",path:h,alt:r||h,caption:M});continue}const S=a.match(/^\s*(?:-|\*|\+)\s+(.*)/);if(S){p||(x(),p=!0,I=!1),f.push((S[1]||"").trim());continue}const N=a.match(/^\s*\d+\.\s+(.*)/);if(N){p||(x(),p=!0,I=!0),f.push((N[1]||"").trim());continue}const q=a.match(/^\s{2,}(.*)/);if(p&&q&&(q[1]||"").trim()&&f.length>0){const r=f[f.length-1];r.endsWith("\\")?f[f.length-1]=r.slice(0,-1).trim()+"<br>"+(q[1]||"").trim():f[f.length-1]+=" "+(q[1]||"").trim();continue}p&&A();const D=a.match(/^>\s*(.*)$/);if(D){u||(x(),u=!0),v.push((D[1]||"").trim());continue}u&&F();const O=a.match(/^\s*\|.*\|\s*$/);if(O&&d+1<e.length){const r=e[d+1]??"";if(/^\s*\|[\s\-:|]+\|\s*$/.test(r)){P||(x(),A(),P=!0),B.push(a.trim());continue}}if(P&&O){B.push(a.trim());continue}if(P&&V(),a.trim()===""){x();continue}s.push(a.trim())}return x(),A(),F(),V(),n}function nt(o,l,c){const e=[];let n=[],s=!1,t=[],g=!1;const k=()=>{if(n.length>0){const E=n.some(f=>f.endsWith("\\"));let p;E?p=n.map(f=>f.endsWith("\\")?f.slice(0,-1).trim():f.trim()).join("<br>").trim():p=n.join(" ").trim(),p&&e.push({type:"paragraph",tokens:R(p,l,c)})}n=[]},j=()=>{t.length>0&&e.push({type:"list",ordered:g,items:t.map(E=>R(E,l,c))}),t=[],s=!1,g=!1};for(let E=0;E<o.length;E++){const p=o[E],f=p.match(/^\s*(?:-|\*|\+)\s+(.*)/);if(f){s||(k(),s=!0,g=!1),t.push((f[1]||"").trim());continue}const I=p.match(/^\s*\d+\.\s+(.*)/);if(I){s||(k(),s=!0,g=!0),t.push((I[1]||"").trim());continue}const u=p.match(/^\s{2,}(.*)/);if(s&&u&&(u[1]||"").trim()&&t.length>0){const v=t[t.length-1];v.endsWith("\\")?t[t.length-1]=v.slice(0,-1).trim()+"<br>"+(u[1]||"").trim():t[t.length-1]+=" "+(u[1]||"").trim();continue}if(s&&j(),p.trim()===""){k();continue}n.push(p)}return k(),j(),e}const ht=[{slug:"meritocracy",title:"Meritocracy",date:"2025-12-09",publish:!0,hasConfig:!1},{slug:"software-maxims",title:"Maxims of good software",date:"2025-11-23",publish:!0,hasConfig:!1},{slug:"accountability-ai-autonomy",title:"Selling software without accountability",date:"2025-10-24T00:00:00.000Z",publish:!0,hasConfig:!1},{slug:"manifesto",title:"Writing manifesto",date:"2025-09-12",publish:!0,hasConfig:!1}],ft=Object.assign({"/src/content/essays/accountability-ai-autonomy.md":()=>Y(()=>import("./accountability-ai-autonomy-e8724bf4.js"),[],import.meta.url).then(o=>o.default),"/src/content/essays/manifesto.md":()=>Y(()=>import("./manifesto-7350ffaf.js"),[],import.meta.url).then(o=>o.default),"/src/content/essays/meritocracy.md":()=>Y(()=>import("./meritocracy-fd185ac6.js"),[],import.meta.url).then(o=>o.default),"/src/content/essays/software-maxims.md":()=>Y(()=>import("./software-maxims-c4743e1f.js"),[],import.meta.url).then(o=>o.default)});async function ut(o){return ht}async function mt(o,l){const c=`/src/content/essays/${o}.md`,e=ft[c];if(!e)throw new Error(`Essay "${o}" not found`);return await e()}async function pt(o,l){if(!l)return{};try{const c=await l(`/assets/essays/${o}/config.json`,{headers:{Accept:"application/json"}});return c.ok?(await c.json()).audio||{}:{}}catch{return{}}}async function dt(o,l){if(!l)return new Set;try{const c=await l(`/assets/essays/${o}/config.json`,{headers:{Accept:"application/json"}});if(c.ok){const n=(await c.json()).code||[];return new Set(n)}return new Set}catch{return new Set}}const gt=async({params:o,fetch:l})=>{const{slug:c}=o;try{const n=(await ut(l)).find(j=>j.slug===c);if(!n)throw at(404,"Essay not found");const s=await mt(c,l),[t,g]=n.hasConfig?await Promise.all([pt(c,l),dt(c,l)]):[{},new Set],k=rt(s,n.title,n.date,t,g);return{slug:c,post:k,publish:n.publish}}catch(e){throw e&&typeof e=="object"&&"status"in e?e:at(404,"Essay not found")}},kt=Object.freeze(Object.defineProperty({__proto__:null,load:gt},Symbol.toStringTag,{value:"Module"}));export{kt as _,gt as l};
